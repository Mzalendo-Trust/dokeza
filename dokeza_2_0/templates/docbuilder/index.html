<!--*
*
* (c) Copyright Ascensio System Limited 2010-2017
*
* The MIT License (MIT)
*
*
*-->
{% load static %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />
    <title>ONLYOFFICE Document Builder</title>
    <link href="{% static 'images/favicon.ico' %} " rel="shortcut icon" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:900,800,700,600,500,400,300&subset=latin,cyrillic-ext,cyrillic,latin-ext" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/stylesheet.css' %}" />
  </head>
  <body>
    <header>
      <a href="/">
        <img src ="{% static 'images/logo.png' %}" alt="ONLYOFFICE" />
      </a>
    </header>
    <div class="main-panel">
      <span class="portal-name">ONLYOFFICE Document Builder â€“ Welcome!</span>
      <span class="portal-descr">Get started with a demo-sample of ONLYOFFICE Document Builder. You may upload your own script for documents using the <b>Upload script</b> button and selecting the necessary file on your PC.</span>
      <div class="help-block">
        <span>Generate a document from the script below, edit it or upload your own script</span>
        <p>Use the script in the textarea below as is to generate the document or you edit it in the textarea window. Or, in case you have a script of your own, use the button under the textarea to upload it.</p>
        <div class="error-message">{{ error_message }}</div>
        <div class="clearFix">
          <form method="post" action=" {% url 'docbuilder:generate' %} " id="Form1">{% csrf_token %}
            <textarea name="PredefinedScript" rows="2" cols="20" id="PredefinedScript">{{ predefined_script }}</textarea>
            <div class="upload-panel clearFix">
              <a id="builderFileLink" class="file-upload">Upload your own script</a>
              <input type="file" id="builderFile" />
              <div class="generate-button-upload">
                <input value="Generate document" id="GenerateButton" type="submit">
              </div>
              <p>Visit <a target="_blank" href="https://api.onlyoffice.com/docbuilder/basic">ONLYOFFICE Document Builder documentation</a> for more script examples.</p>
            </div>
          </form>
          <form method="post" action="{% url 'docbuilder:create' %}" id="Form2">{% csrf_token %}
            <div class="create-panel clearFix">
              <span>Or create a new file from a sample script with your own data</span>
              Fill the data into the text areas below so that it could appear in the output document. Or leave it blank, in this case the default values (now shown as watermarks in the text area) will be added to the resulting document.
              <ul class="try-editor-list clearFix">
                <li>
                  <input name="docx" value="Create Document" id="CreateDocx" class="try-editor document" type="submit" />
                </li>
                <li>
                  <input name="xlsx" value="Create Spreadsheet" id="CreateXlsx" class="try-editor spreadsheet" type="submit" />
                </li>
                <li>
                  <input name="pdf" value="Create PDF" id="CreatePdf" class="try-editor presentation" type="submit" />
                </li>
              </ul>
              <div class="own-data-enter">
                <label>Name: </label>
                <input name="NameText" id="NameText" class="input" placeholder="John Smith" type="text" />
                <label>Company: </label>
                <input name="CompanyText" id="CompanyText" class="input" placeholder="ONLYOFFICE" type="text" />
                <label>Position/Title: </label>
                <input name="TitleText" id="TitleText" class="input" placeholder="Commercial director" type="text" />
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="help-block">
        <form method="post" action="{% url 'docbuilder:upload' %}" id="Form3" enctype="multipart/form-data">{% csrf_token %}
          <div class="upload-panel clearFix">
            <input name="document" type="file" id="uploadDocx" />
            <button type="submit">upload to server</button>
          </div>
        </form>
        <form method="post" action="{% url 'docbuilder:generate-report' 'comments' %}" id="Form4">{% csrf_token %}
          <div class="generate-report">
            <input value="Generate report from document" id="GenerateReport" type="submit">
          </div>
        </form>
        <p>Uploaded files:</p>
        <ul>
          {% if uploaded_file_url %}
            <p>File uploaded at: <a href="{{ uploaded_file_url }}">{{ uploaded_file_url }}</a></p>
          {% endif %}
        </ul>
      </div>
      <div class="help-block">
        <span>Any questions?</span>
        Please, <a href="mailto:sales@onlyoffice.com">submit your request here</a>.
      </div>
    </div>
  <footer>&copy; Ascensio Systems Inc 2020. All rights reserved.</footer>
  <script type="text/javascript" src="{% static 'js/jscript.js' %}"></script>
</body>
</html>